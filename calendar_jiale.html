
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Touch Grass ‚Äî Navbar</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  />
  <!-- Bootstrap Icons -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    rel="stylesheet"
  />
  <!-- site styles  -->
  <link rel="stylesheet" href="styles.css">

  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.css" rel="stylesheet" />

  <style>
    li {
      list-style-type: none;
      font-size: 26px;
    }
    /* highlight favourited events visually */
    .tg-favorite-event {
      outline: 2px solid #ffd166;
      border-radius: .25rem;
    }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-touchgrass" aria-label="Touch Grass main navigation">
  <div class="container">
    <!-- Left: Brand -->
    <a class="navbar-brand d-flex align-items-center gap-2" href="/">
      <!-- Inline grass SVG logo -->
      <svg class="grass-logo" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Touch Grass logo">
        <rect x="0" y="44" width="64" height="6" fill="var(--tg-primary)"/>
        <path d="M8 44 q2-10 6-16 q-2 8 2 16 M16 44 q2-12 8-20 q-3 10 1 20 M24 44 q3-14 10-24 q-4 12 0 24
                 M32 44 q2-12 8-20 q-3 10 0 20 M40 44 q3-14 10-24 q-4 12 0 24 M48 44 q2-10 6-16 q-2 8 2 16"
              stroke="var(--tg-primary)" stroke-width="2" fill="none" stroke-linecap="round"/>
      </svg>
      <span>Touch Grass</span>
    </a>

    <!-- Mobile toggler (collapse below lg) -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#tgNav"
            aria-controls="tgNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="tgNav">
      <!-- Middle: Search -->
      <form id="eventSearchForm" class="mx-lg-auto my-3 my-lg-0 w-100" role="search" action="/search" method="get">
        <div class="input-group">
          <span class="input-group-text" id="search-addon"><i class="bi bi-search"></i></span>
          <input type="search" class="form-control" name="q" placeholder="Search events"
                 aria-label="Search events" aria-describedby="search-addon" />
          <button class="btn btn-tg" type="submit">Search</button>
        </div>
      </form>

      <!-- Right: Icons -->
      <ul class="navbar-nav ms-lg-auto align-items-lg-center gap-lg-2">
        <li class="nav-item">
          <a class="nav-link d-flex align-items-center gap-2" href="/profile" aria-label="Profile" title="Profile">
            <i class="bi bi-person-circle fs-5"></i>
            <span class="d-none d-xl-inline">Profile</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link d-flex align-items-center gap-2" href="/favourites" aria-label="Favourites" title="Favourites">
            <i class="bi bi-heart fs-5"></i>
            <span class="d-none d-xl-inline">Favourites</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link d-flex align-items-center gap-2" href="/itinerary" aria-label="Itinerary planner" title="Itinerary planner">
            <i class="bi bi-calendar-event fs-5"></i>
            <span class="d-none d-xl-inline">Itinerary</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container-fluid d-flex align-items-start py-3">
  <!-- friends list/saved filters -->
  <section class="filters text-center col-12 col-lg-4 h-100">
    <h2>Friends</h2>
    <ul class="friends-list">
      <li>
        <span>John Doe</span>
        <input type="checkbox" class="friend-check" value="John Doe">
      </li>
      <li>
        <span>Jane Smith</span>
        <input type="checkbox" class="friend-check" value="Jane Smith">
      </li>
      <li>
        <span>Michael Tan</span>
        <input type="checkbox" class="friend-check" value="Michael Tan">
      </li>
      <li>
        <span>Sarah Lim</span>
        <input type="checkbox" class="friend-check" value="Sarah Lim">
      </li>
    </ul>

    <div class="btn-group d-flex flex-column align-items-center">
      <!-- give the favourites button a hook class -->
      <button class="btn btn-primary mb-2 w-50 btn-favourites" type="button">‚≠ê Hide Favourites</button>
      <button class="btn btn-outline-secondary mb-2 w-50" type="button">üíæ Saved</button>
    </div>
  </section>

  <!-- calendar -->
  <section class="calendar-section text-center col-12 col-lg-8">
    <div class="calendar-card" id="calendarCard">
      <h1 id="calendarTitle">My Google Calendar</h1>
      <p class="lead">Upcoming events (interactive)</p>

      <div id="events" class="events" aria-live="polite">
        <!-- replaced the Google Calendar iframe with a div for FullCalendar -->
        <div id="tgCalendar" aria-label="Interactive calendar showing events"></div>
      </div>

      <div class="meta">
        <span id="lastUpdated"></span>
      </div>

      <div class="small-note">
        This demo renders events locally so you can filter favourites. You can later swap the data source to Google Calendar API.
      </div>
    </div>
  </section>
</div>

<!-- Bootstrap JS (with Popper) -->
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
  crossorigin="anonymous"></script>

<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('tgCalendar');

    // --- Fake events (some marked as favourite: true) ---
    // dates use Asia/Singapore timezone
    const allEvents = [
      {
        id: 'e1',
        title: 'Botanic Gardens Picnic',
        start: '2025-10-14T12:00:00',
        end: '2025-10-14T14:00:00',
        location: 'Singapore Botanic Gardens',
        favourite: false
      },
      {
        id: 'e2',
        title: 'East Coast Cycling',
        start: '2025-10-16T09:00:00',
        end: '2025-10-16T11:00:00',
        location: 'East Coast Park',
        favourite: false
      },
      {
        id: 'e3',
        title: 'MacRitchie Hike',
        start: '2025-10-18',
        allDay: true,
        location: 'MacRitchie Reservoir',
        favourite: false
      },
      {
        id: 'e4',
        title: 'Pulau Ubin Photoshoot',
        start: '2025-10-20T08:30:00',
        end: '2025-10-20T12:30:00',
        location: 'Pulau Ubin',
        favourite: false
      }
    ];

    // --- Create FullCalendar instance ---
    const calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      height: 'auto',
      timeZone: 'Asia/Singapore',
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
      },
      events: allEvents,
      eventDidMount: function (info) {
        // add a visual cue for favourite events
        if (info.event.extendedProps.favourite) {
          info.el.classList.add('tg-favorite-event');
          // accessibility labels and title hint
          const base = info.el.getAttribute('aria-label') || info.event.title;
          info.el.setAttribute('aria-label', base + ' (favourite)');
          info.el.title = (info.el.title || info.event.title) + ' ‚òÖ favourite';
        }
      },
      eventMouseEnter: function(info) {
        // optional: show location in browser tooltip
        if (info.event.extendedProps.location) {
          info.el.title = info.event.title + (info.event.extendedProps.favourite ? ' ‚òÖ' : '') +
            '\\n' + info.event.extendedProps.location;
        }
      }
    });

    calendar.render();

    // update "last updated" meta
    const lastUpdatedEl = document.getElementById('lastUpdated');
    if (lastUpdatedEl) {
      const now = new Date();
      lastUpdatedEl.textContent = 'Last updated: ' + now.toLocaleString('en-SG', { hour12: false });
    }

    // --- Favourites toggle logic ---
    const favBtn = document.querySelector('.btn-favourites');
    let showingFavouritesOnly = false;

    function refreshEvents() {
      const data = showingFavouritesOnly
        ? allEvents.filter(e => e.favourite)
        : allEvents;

      calendar.removeAllEvents();
      calendar.addEventSource(data);
    }

    favBtn?.addEventListener('click', () => {
      showingFavouritesOnly = !showingFavouritesOnly;
      favBtn.classList.toggle('active', showingFavouritesOnly);
      favBtn.textContent = showingFavouritesOnly ? '‚≠ê Show Favourites' : '‚≠ê Hide Favourites';
      refreshEvents();
    });
  });
</script>
</body>
</html>

